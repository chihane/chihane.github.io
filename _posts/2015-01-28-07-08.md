---
layout: post
title: 之前写的一个用泛型简化了使用的存取SharedPreferences的工具类
date: 2015-01-28 07:08:00
categories: cnblogs
---

<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/**</span><span style="color: #008000;"> SharedPreferences简易存取。 </span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Prefs {
</span><span style="color: #008080;"> 3</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 4</span> <span style="color: #008000;">     * 向首选项中设置值。&lt;/br&gt;
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;">     * 
</span><span style="color: #008080;"> 6</span> <span style="color: #008000;">     * value的实际类型需要是&lt;b&gt;boolean&lt;/b&gt;、&lt;b&gt;float&lt;/b&gt;、&lt;b&gt;int&lt;/b&gt;、&lt;b&gt;long&lt;/b&gt;、&lt;b&gt;String&lt;/b&gt;之一，否则不作处理。
</span><span style="color: #008080;"> 7</span> <span style="color: #008000;">     * </span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> put(Context context, String key, Object value) {
</span><span style="color: #008080;"> 9</span>         Editor editor =<span style="color: #000000;"> context.getSharedPreferences(context.getPackageName(), Context.MODE_PRIVATE).edit();
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span>         <span style="color: #0000ff;">if</span> (value <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Boolean) {
</span><span style="color: #008080;">12</span> <span style="color: #000000;">            editor.putBoolean(key, (Boolean) value);
</span><span style="color: #008080;">13</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (value <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Float) {
</span><span style="color: #008080;">14</span> <span style="color: #000000;">            editor.putFloat(key, (Float) value);
</span><span style="color: #008080;">15</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (value <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Integer) {
</span><span style="color: #008080;">16</span> <span style="color: #000000;">            editor.putInt(key, (Integer) value);
</span><span style="color: #008080;">17</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (value <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Long) {
</span><span style="color: #008080;">18</span> <span style="color: #000000;">            editor.putLong(key, (Long) value);
</span><span style="color: #008080;">19</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (value <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> String) {
</span><span style="color: #008080;">20</span> <span style="color: #000000;">            editor.putString(key, (String) value);
</span><span style="color: #008080;">21</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">22</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> 按说应该抛异常。</span>
<span style="color: #008080;">23</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span> <span style="color: #000000;">        editor.commit();
</span><span style="color: #008080;">26</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">27</span> 
<span style="color: #008080;">28</span>     <span style="color: #008000;">/**</span><span style="color: #008000;"> 从首选项中取值。 </span><span style="color: #008000;">*/</span>
<span style="color: #008080;">29</span>     @SuppressWarnings("unchecked"<span style="color: #000000;">)
</span><span style="color: #008080;">30</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> &lt;P&gt;<span style="color: #000000;"> P get(Context context, String key, P defValue) {
</span><span style="color: #008080;">31</span>         SharedPreferences prefs =<span style="color: #000000;"> context.getSharedPreferences(context.getPackageName(), Context.MODE_PRIVATE);
</span><span style="color: #008080;">32</span> 
<span style="color: #008080;">33</span>         Object result = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">34</span> 
<span style="color: #008080;">35</span>         <span style="color: #0000ff;">if</span> (defValue <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Boolean) {
</span><span style="color: #008080;">36</span>             result =<span style="color: #000000;"> prefs.getBoolean(key, (Boolean) defValue);
</span><span style="color: #008080;">37</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (defValue <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Float) {
</span><span style="color: #008080;">38</span>             result =<span style="color: #000000;"> prefs.getFloat(key, (Float) defValue);
</span><span style="color: #008080;">39</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (defValue <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Integer) {
</span><span style="color: #008080;">40</span>             result =<span style="color: #000000;"> prefs.getInt(key, (Integer) defValue);
</span><span style="color: #008080;">41</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (defValue <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> Long) {
</span><span style="color: #008080;">42</span>             result =<span style="color: #000000;"> prefs.getLong(key, (Long) defValue);
</span><span style="color: #008080;">43</span>         } <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (defValue <span style="color: #0000ff;">instanceof</span><span style="color: #000000;"> String) {
</span><span style="color: #008080;">44</span>             result =<span style="color: #000000;"> prefs.getString(key, (String) defValue);
</span><span style="color: #008080;">45</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">46</span> 
<span style="color: #008080;">47</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> (P) result;
</span><span style="color: #008080;">48</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">49</span> }</pre>
</div>
<p>&nbsp;</p>
<p>应该没有什么再简化的余地了。</p>
<p>告别强转和一大堆方法提示，省心省力。</p>
<p>&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('85f1b1d2-5b08-462e-82a5-c61ed1634424')"><img id="code_img_closed_85f1b1d2-5b08-462e-82a5-c61ed1634424" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_85f1b1d2-5b08-462e-82a5-c61ed1634424" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('85f1b1d2-5b08-462e-82a5-c61ed1634424',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_85f1b1d2-5b08-462e-82a5-c61ed1634424" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/**</span><span style="color: #008000;"> Log的简易类。 </span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> L {
</span><span style="color: #008080;"> 3</span>     <span style="color: #008000;">/**</span><span style="color: #008000;"> 日志标签。</span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 4</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String TAG = "MTK"<span style="color: #000000;">;
</span><span style="color: #008080;"> 5</span>     
<span style="color: #008080;"> 6</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> v(String msg) {
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">        Log.v(TAG, msg);
</span><span style="color: #008080;"> 8</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> v(<span style="color: #0000ff;">boolean</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">11</span>         Log.v(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">12</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">13</span> 
<span style="color: #008080;">14</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> v(<span style="color: #0000ff;">int</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">15</span>         Log.v(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">16</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> d(String msg) {
</span><span style="color: #008080;">19</span> <span style="color: #000000;">        Log.d(TAG, msg);
</span><span style="color: #008080;">20</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> d(<span style="color: #0000ff;">boolean</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">23</span>         Log.d(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">24</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">25</span> 
<span style="color: #008080;">26</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> d(<span style="color: #0000ff;">int</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">27</span>         Log.d(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">28</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">29</span> 
<span style="color: #008080;">30</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> i(String msg) {
</span><span style="color: #008080;">31</span> <span style="color: #000000;">        Log.i(TAG, msg);
</span><span style="color: #008080;">32</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">33</span> 
<span style="color: #008080;">34</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> i(<span style="color: #0000ff;">boolean</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">35</span>         Log.i(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">36</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">37</span> 
<span style="color: #008080;">38</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> i(<span style="color: #0000ff;">int</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">39</span>         Log.i(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">40</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">41</span> 
<span style="color: #008080;">42</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> w(String msg) {
</span><span style="color: #008080;">43</span> <span style="color: #000000;">        Log.w(TAG, msg);
</span><span style="color: #008080;">44</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">45</span> 
<span style="color: #008080;">46</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> w(<span style="color: #0000ff;">boolean</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">47</span>         Log.w(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">48</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">49</span> 
<span style="color: #008080;">50</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> w(<span style="color: #0000ff;">int</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">51</span>         Log.w(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">52</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">53</span> 
<span style="color: #008080;">54</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> e(String msg) {
</span><span style="color: #008080;">55</span> <span style="color: #000000;">        Log.e(TAG, msg);
</span><span style="color: #008080;">56</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">57</span> 
<span style="color: #008080;">58</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> e(<span style="color: #0000ff;">boolean</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">59</span>         Log.e(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">60</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">61</span> 
<span style="color: #008080;">62</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> e(<span style="color: #0000ff;">int</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">63</span>         Log.e(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">64</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">65</span> 
<span style="color: #008080;">66</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> wtf(String msg) {
</span><span style="color: #008080;">67</span> <span style="color: #000000;">        Log.wtf(TAG, msg);
</span><span style="color: #008080;">68</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">69</span> 
<span style="color: #008080;">70</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> wtf(<span style="color: #0000ff;">boolean</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">71</span>         Log.wtf(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">72</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">73</span> 
<span style="color: #008080;">74</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> wtf(<span style="color: #0000ff;">int</span><span style="color: #000000;"> msg) {
</span><span style="color: #008080;">75</span>         Log.wtf(TAG, msg + ""<span style="color: #000000;">);
</span><span style="color: #008080;">76</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">77</span> }</pre>
</div>
<span class="cnblogs_code_collapse">附赠另两</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('218e650d-c44a-4e8e-af44-18921a06d79b')"><img id="code_img_closed_218e650d-c44a-4e8e-af44-18921a06d79b" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_218e650d-c44a-4e8e-af44-18921a06d79b" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('218e650d-c44a-4e8e-af44-18921a06d79b',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_218e650d-c44a-4e8e-af44-18921a06d79b" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">/**</span><span style="color: #008000;"> 简易Toast。 </span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> T {
</span><span style="color: #008080;"> 3</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;"> 4</span> <span style="color: #008000;">     * 显示长时间的Toast。
</span><span style="color: #008080;"> 5</span> <span style="color: #008000;">     * 
</span><span style="color: #008080;"> 6</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@see</span><span style="color: #008000;"> Toast#LENGTH_LONG
</span><span style="color: #008080;"> 7</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> showLong(Context context, String text) {
</span><span style="color: #008080;"> 9</span> <span style="color: #000000;">        Toast.makeText(context, text, Toast.LENGTH_LONG).show();
</span><span style="color: #008080;">10</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">11</span> 
<span style="color: #008080;">12</span>     <span style="color: #008000;">/**</span>
<span style="color: #008080;">13</span> <span style="color: #008000;">     * 显示长时间的Toast。
</span><span style="color: #008080;">14</span> <span style="color: #008000;">     * 
</span><span style="color: #008080;">15</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@see</span><span style="color: #008000;"> Toast#LENGTH_SHORT
</span><span style="color: #008080;">16</span>      <span style="color: #008000;">*/</span>
<span style="color: #008080;">17</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> showShort(Context context, String text) {
</span><span style="color: #008080;">18</span> <span style="color: #000000;">        Toast.makeText(context, text, Toast.LENGTH_SHORT).show();
</span><span style="color: #008080;">19</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">20</span> }</pre>
</div>
<span class="cnblogs_code_collapse">个没有什么营养的工具类</span></div>
<p>&nbsp;</p>
<p>请随意取用。</p>

<div align=right><a href="https://github.com/mlxy/SRBCnblogs"><font size=1>——本文由博客园搬家工具SRBCnblogs转换而成</font></a></div>