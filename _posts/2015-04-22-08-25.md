---
layout: post
title: 千年之恋
date: 2015-04-22 08:25:00
categories: cnblogs
---

<p>指我和字符编码。</p>
<p>&nbsp;</p>
<p>今天写文档，需要把所有源码填到一个Word文档里，因为一个一个打开复制很麻烦，于是打算用Python弄。</p>
<p>当然最后花了更多的时间。</p>
<p>也是可以预见的。</p>
<p>&nbsp;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('d52c6142-06de-4f9d-940a-927ab3ad8f9a')"><img id="code_img_closed_d52c6142-06de-4f9d-940a-927ab3ad8f9a" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_d52c6142-06de-4f9d-940a-927ab3ad8f9a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('d52c6142-06de-4f9d-940a-927ab3ad8f9a',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_d52c6142-06de-4f9d-940a-927ab3ad8f9a" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">#</span><span style="color: #008000;">encoding:utf-8</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> os
</span><span style="color: #008080;"> 3</span> 
<span style="color: #008080;"> 4</span> dir = r<span style="color: #800000;">'</span><span style="color: #800000;">C:\Users\mlxy\workspace\Project\src</span><span style="color: #800000;">'</span>
<span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span> <span style="color: #0000ff;">def</span><span style="color: #000000;"> fetchFileRecursively(dir, fileExt):
</span><span style="color: #008080;"> 7</span>     <span style="color: #800000;">'''</span><span style="color: #800000;"> 递归获取路径下所有指定扩展名的文件的绝对路径作为列表返回。</span><span style="color: #800000;">'''</span>
<span style="color: #008080;"> 8</span>     result =<span style="color: #000000;"> []
</span><span style="color: #008080;"> 9</span>     
<span style="color: #008080;">10</span>     files =<span style="color: #000000;"> os.listdir(dir)
</span><span style="color: #008080;">11</span>     
<span style="color: #008080;">12</span>     <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> files:
</span><span style="color: #008080;">13</span>         <span style="color: #008000;">#</span><span style="color: #008000;"> 拼完整路径。</span>
<span style="color: #008080;">14</span>         file =<span style="color: #000000;"> os.path.join(dir, i)
</span><span style="color: #008080;">15</span>         
<span style="color: #008080;">16</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> os.path.isdir(file):
</span><span style="color: #008080;">17</span> <span style="color: #000000;">            result.extend(fetchFileRecursively(file, fileExt))
</span><span style="color: #008080;">18</span>         <span style="color: #0000ff;">elif</span><span style="color: #000000;"> os.path.isfile(file):
</span><span style="color: #008080;">19</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> i.endswith(fileExt):
</span><span style="color: #008080;">20</span> <span style="color: #000000;">                result.append(file)
</span><span style="color: #008080;">21</span>             
<span style="color: #008080;">22</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> result
</span><span style="color: #008080;">23</span> 
<span style="color: #008080;">24</span> <span style="color: #0000ff;">def</span><span style="color: #000000;"> readContent(file):
</span><span style="color: #008080;">25</span>     <span style="color: #800000;">'''</span><span style="color: #800000;"> 读取文件内容。</span><span style="color: #800000;">'''</span>
<span style="color: #008080;">26</span>     with open(file, <span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">) as f:
</span><span style="color: #008080;">27</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> f.read()
</span><span style="color: #008080;">28</span>     
<span style="color: #008080;">29</span> <span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
</span><span style="color: #008080;">30</span>     javas = fetchFileRecursively(dir, <span style="color: #800000;">'</span><span style="color: #800000;">java</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">31</span>     
<span style="color: #008080;">32</span>     with open(<span style="color: #800000;">'</span><span style="color: #800000;">result.txt</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span><span style="color: #000000;">) as f:
</span><span style="color: #008080;">33</span>         <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> javas:
</span><span style="color: #008080;">34</span>             content = readContent(i).decode(<span style="color: #800000;">'</span><span style="color: #800000;">u8</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">ignore</span><span style="color: #800000;">'</span>).encode(<span style="color: #800000;">'</span><span style="color: #800000;">u8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">35</span>             f.write(content+<span style="color: #800000;">'</span><span style="color: #800000;">\n</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">36</span> 
<span style="color: #008080;">37</span>     <span style="color: #0000ff;">print</span> <span style="color: #800000;">'</span><span style="color: #800000;">Done.</span><span style="color: #800000;">'</span></pre>
</div>
<span class="cnblogs_code_collapse">编码问题我则已经放弃了思考</span></div>
<p>我真的不明白用同一种编码先decode又encode是一种什么疾病了。</p>

<div align=right><a href="https://github.com/mlxy"><font size=1>——本文由博客园搬家工具SRBCnblogs转换而成</font></a></div>