---
layout: post
title: 我们中出了一个叛徒
date: 2015-04-23 02:26:00
categories: cnblogs
---

<div class="cnblogs_code" onclick="cnblogs_code_show('e40325e4-3516-4108-90f6-a6b87f5545d9')"><img id="code_img_closed_e40325e4-3516-4108-90f6-a6b87f5545d9" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_e40325e4-3516-4108-90f6-a6b87f5545d9" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e40325e4-3516-4108-90f6-a6b87f5545d9',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_e40325e4-3516-4108-90f6-a6b87f5545d9" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #008000;">#</span><span style="color: #008000;">encoding:utf-8</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> os
</span><span style="color: #008080;"> 3</span>  
<span style="color: #008080;"> 4</span> dir = r<span style="color: #800000;">'</span><span style="color: #800000;">c:\Users\mlxy\workspace\Project\src</span><span style="color: #800000;">'</span>
<span style="color: #008080;"> 5</span>  
<span style="color: #008080;"> 6</span> <span style="color: #0000ff;">def</span><span style="color: #000000;"> fetchFileRecursively(dir, fileExt):
</span><span style="color: #008080;"> 7</span>     <span style="color: #800000;">'''</span><span style="color: #800000;"> 递归获取路径下所有指定扩展名的文件的绝对路径作为列表返回。</span><span style="color: #800000;">'''</span>
<span style="color: #008080;"> 8</span>     result =<span style="color: #000000;"> []
</span><span style="color: #008080;"> 9</span>     
<span style="color: #008080;">10</span>     files =<span style="color: #000000;"> os.listdir(dir)
</span><span style="color: #008080;">11</span>     
<span style="color: #008080;">12</span>     <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> files:
</span><span style="color: #008080;">13</span>         <span style="color: #008000;">#</span><span style="color: #008000;"> 拼完整路径。</span>
<span style="color: #008080;">14</span>         file =<span style="color: #000000;"> os.path.join(dir, i)
</span><span style="color: #008080;">15</span>         
<span style="color: #008080;">16</span>         <span style="color: #0000ff;">if</span><span style="color: #000000;"> os.path.isdir(file):
</span><span style="color: #008080;">17</span> <span style="color: #000000;">            result.extend(fetchFileRecursively(file, fileExt))
</span><span style="color: #008080;">18</span>         <span style="color: #0000ff;">elif</span><span style="color: #000000;"> os.path.isfile(file):
</span><span style="color: #008080;">19</span>             <span style="color: #0000ff;">if</span><span style="color: #000000;"> i.endswith(fileExt):
</span><span style="color: #008080;">20</span> <span style="color: #000000;">                result.append(file)
</span><span style="color: #008080;">21</span>             
<span style="color: #008080;">22</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> result
</span><span style="color: #008080;">23</span> 
<span style="color: #008080;">24</span>     
<span style="color: #008080;">25</span> <span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
</span><span style="color: #008080;">26</span>     javas = fetchFileRecursively(dir, <span style="color: #800000;">'</span><span style="color: #800000;">java</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">27</span>     
<span style="color: #008080;">28</span>     with open(<span style="color: #800000;">'</span><span style="color: #800000;">result.txt</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span><span style="color: #000000;">) as f:
</span><span style="color: #008080;">29</span>         <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> javas:
</span><span style="color: #008080;">30</span>             with open(i, <span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">) as file:
</span><span style="color: #008080;">31</span> <span style="color: #000000;">                f.write(file.read())
</span><span style="color: #008080;">32</span>  
<span style="color: #008080;">33</span>     <span style="color: #0000ff;">print</span> <span style="color: #800000;">'</span><span style="color: #800000;">Done.</span><span style="color: #800000;">'</span></pre>
</div>
<span class="cnblogs_code_collapse">干掉了啰嗦的部分</span></div>
<p>&nbsp;</p>
<p>嗯&hellip;&hellip;</p>
<p>有一个复制来的代码文件，它实际上是GBK的。</p>
<p>然后把它硬转成了UTF8，于是里面一段中文注释就乱码了。</p>
<p>但是因为是注释，结果就没报错，于是就没发现。</p>
<p>然后把这段乱码和其他的文件一起写出就全乱码了。</p>
<p>&nbsp;</p>
<p>差不多就是这样&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>总之现在没问题了。</p>
<p>&nbsp;</p>
<p>话说我每次字符编码问题到最后也都解决了&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>我是不是该开个字符编码的分类了&hellip;&hellip;</p>

<p align=right><span style="font-size: 12px">——本文由博客园搬家工具<a href="https://github.com/mlxy/SRBCnblogs">SRBCnblogs</a>转换而成</span></p>