---
layout: post
title: 传一个jcenter
date: 2015-10-15 08:57:00
categories: cnblogs
---

<p>格式仿佛是乱了&hellip;&hellip;</p>
<p>就这样吧&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>=========================================================</p>
<p>&nbsp;</p>
<p>工程的build.gradle下加上</p>
<div class="cnblogs_code">
<pre>classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:1.0'<span style="color: #000000;">
classpath </span>'com.github.dcendents:android-maven-plugin:1.2'</pre>
</div>
<p>如果gradle版本在2.4.0以上，就把第二个改成<sup>[1]</sup></p>
<div class="cnblogs_code">
<pre>classpath 'com.github.dcendents:android-maven-gradle-plugin:1.3'</pre>
</div>
<p>&nbsp;</p>
<p>&mdash;&mdash;以下加粗内容是需要自己修改的部分</p>
<p>然后进入库模块的build.gradle，根节点里&mdash;&mdash;以下不特别说明都是在根节点里&mdash;&mdash;添加插件</p>
<div class="cnblogs_code">
<pre>apply plugin: 'com.github.dcendents.android-maven'<span style="color: #000000;">
apply plugin: </span>'com.jfrog.bintray'</pre>
</div>
<p><strong>定义版本</strong></p>
<div class="cnblogs_code">
<pre><strong>version = "0.1"</strong></pre>
</div>
<p><strong>添加网站，其中siteUrl是项目官网，没有的话就用Github吧</strong></p>
<div class="cnblogs_code">
<pre><strong>def siteUrl = 'https://github.com/&lt;user&gt;/&lt;project&gt;'
def gitUrl = 'https://github.com/&lt;user&gt;/&lt;project&gt;.git'</strong></pre>
</div>
<p><strong>定义包名</strong></p>
<div class="cnblogs_code">
<pre><strong>group = "com.user.project"</strong></pre>
</div>
<p><strong>添加打包脚本</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">//</span><span style="color: #008000;"> 根节点添加</span>
<span style="color: #000000;">install {
    repositories.mavenInstaller {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> This generates POM.xml with proper parameters</span>
<span style="color: #000000;">        pom {
            project {
                packaging </span>'aar'<strong><span style="color: #000000;">
                name </span>'ProjectName'</strong><span style="color: #000000;">
                url siteUrl
                licenses {
                    license {
<strong>                        name </strong></span><strong>'The Apache Software License, Version 2.0'<span style="color: #000000;">
                        url </span>'http://www.apache.org/licenses/LICENSE-2.0.txt'</strong><span style="color: #000000;">
                    }
                }
                developers {
                    developer {
<strong>                        id </strong></span><strong>'myid'<span style="color: #000000;">
                        name </span>'myname'<span style="color: #000000;">
                        email </span>'email@host.com'</strong><span style="color: #000000;">
                    }
                }
                scm {
                    connection gitUrl
                    developerConnection gitUrl
                    url siteUrl
                }
            }
        }
    }
}</span></pre>
</div>
<p>添加文档和源码打包脚本</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">task sourcesJar(type: Jar) {
    from android.sourceSets.main.java.srcDirs
    classifier </span>= 'sources'<span style="color: #000000;">
}

task javadoc(type: Javadoc) {
    source </span>=<span style="color: #000000;"> android.sourceSets.main.java.srcDirs
    classpath </span>+=<span style="color: #000000;"> project.files(android.getBootClasspath().join(File.pathSeparator))
}

task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier </span>= 'javadoc'<span style="color: #000000;">
    from javadoc.destinationDir
}

artifacts {
    archives javadocJar
    archives sourcesJar
}</span></pre>
</div>
<p>&nbsp;</p>
<p>然后在local.properties里加上bintray上的用户名和密码，另外这个文件就不要往Github上传了</p>
<div class="cnblogs_code">
<pre>bintray.user=username
bintray.apikey=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</pre>
</div>
<p>然后回到库模块的build.gradle里继续添加</p>
<div class="cnblogs_code">
<pre>Properties properties = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Properties()
properties.load(project.rootProject.file(</span>'local.properties'<span style="color: #000000;">).newDataInputStream())
bintray {
    user </span>= properties.getProperty("bintray.user"<span style="color: #000000;">)
    key </span>= properties.getProperty("bintray.apikey"<span style="color: #000000;">)
    configurations </span>= ['archives'<span style="color: #000000;">]
    pkg {
        repo </span>= "maven"<strong><span style="color: #000000;">
        name </span>= "project name in jcenter"</strong>
        websiteUrl =<span style="color: #000000;"> siteUrl
        vcsUrl </span>=<span style="color: #000000;"> gitUrl
<strong>        licenses </strong></span><strong>= ["Apache-2.0"</strong><span style="color: #000000;"><strong>]</strong>
        publish </span>= <span style="color: #0000ff;">true</span><span style="color: #000000;">
    }
}</span></pre>
</div>
<p>&nbsp;</p>
<p>于是就修改完成。</p>
<p>然后依次跑</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">javadocJar

sourcesJar

install

bintrayUpload</span></pre>
</div>
<p>这四个脚本任务，用Android Studio右侧的Gradle栏直接双击执行更方便一点。</p>
<p>&nbsp;</p>
<p>不出问题的话Bintray上的last activity里就会显示你已经创建了一个新项目，进去之后把鼠标放在MavenCentral标签上会有提示，点一下get it included，之后等审核就行了。</p>
<p>但出了问题的话。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>我也救不了你&hellip;&hellip;</p>
<p>&nbsp;</p>
<p>感谢前人指路。给您磕个头。&darr;</p>
<p><a href="http://www.cnblogs.com/qianxudetianxia/p/4322331.html" target="_blank"><strong>http://www.cnblogs.com/qianxudetianxia/p/4322331.html</strong></a></p>
<p>&nbsp;</p>
<p>参考来源：</p>
<p>[1]:http://stackoverflow.com/questions/30514274/cannot-build-library-project-bintray-gradle-classnotfoundexception</p>

<div align=right><a href="https://github.com/mlxy"><font size=1>——本文由博客园搬家工具SRBCnblogs转换而成</font></a></div>