---
layout: post
title: 简化至只剩条码和二维码扫描功能的ZXing
date: 2014-07-20 09:04:00
categories: cnblogs
---

<p>基于这位的源码修改的。</p>
<p>http://blog.csdn.net/ryantang03/article/details/7831826</p>
<p>&nbsp;</p>
<p>去除了他加入的生成二维码图片的功能，节约了一个包。</p>
<p>去掉了扫描成功后的音效，节约了一个音效文件。</p>
<p>去掉了闪光灯功能，晚上扫什么码赶紧睡觉。节约了一个类。</p>
<p>去掉了扫描超时，节约了两个类。</p>
<p>去掉了扫描界面的标题栏，节约了一个图片文件。</p>
<p>&nbsp;</p>
<p>一切以易用为目的，zxing这玩意太麻烦了。</p>
<p>修改后的代码最后发。</p>
<p>&nbsp;</p>
<p>要用的话，首先当然是复制文件。</p>
<p>1. libs文件夹里的jar包</p>
<p>2.&nbsp;除了入口Activity以外的四个包</p>
<p>3.&nbsp;布局文件camera.xml</p>
<p>4.&nbsp;值文件colors.xml和ids.xml</p>
<p>这样就可以了，精简前还要麻烦得多。</p>
<p>&nbsp;</p>
<p>然后会发现有很多错误，主要是R类的引用错误。</p>
<p>Eclipse里直接Ctrl+Shift+O改成自己工程的R文件。</p>
<p>&nbsp;</p>
<p>之后如下增加相机和震动的用户权限，同时把连相机都没有的用户挡在门外。</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">uses-permission </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">="android.permission.CAMERA"</span> <span style="color: #0000ff;">/&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">uses-permission </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">="android.permission.VIBRATE"</span> <span style="color: #0000ff;">/&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">uses-feature </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">="android.hardware.camera"</span> <span style="color: #0000ff;">/&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">uses-feature </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">="android.hardware.camera.autofocus"</span> <span style="color: #0000ff;">/&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>扫描界面CaptureActivity还没有加入Manifest，处理好。</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">activity
    </span><span style="color: #ff0000;">android:name</span><span style="color: #0000ff;">="com.zxing.activity.CaptureActivity"</span><span style="color: #ff0000;">
    android:configChanges</span><span style="color: #0000ff;">="orientation|keyboardHidden"</span><span style="color: #ff0000;">
    android:screenOrientation</span><span style="color: #0000ff;">="portrait"</span><span style="color: #ff0000;">
    android:theme</span><span style="color: #0000ff;">="@android:style/Theme.NoTitleBar.Fullscreen"</span><span style="color: #ff0000;">
    android:windowSoftInputMode</span><span style="color: #0000ff;">="stateAlwaysHidden"</span> <span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">activity</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>准备工作完成，可以开始用了。</p>
<p>&nbsp;</p>
<p>写好OnActivityResult方法。</p>
<p>用startActivityForResult来启动CaptureActivity。</p>
<p>然后等着结果就可以了。</p>
<p>&nbsp;</p>
<p>搞掂。</p>
<p>&nbsp;</p>
<p><a href="http://files.cnblogs.com/JavaForNow/TestBarcodeScanner.zip">TestBarCodeScanner</a></p>

<div align=right><a href="https://github.com/mlxy"><font size=1>——本文由博客园搬家工具SRBCnblogs转换而成</font></a></div>