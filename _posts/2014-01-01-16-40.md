---
layout: post
title: 高产赛母猪
date: 2014-01-01 16:40:00
categories: cnblogs
---

<p>　　其实就是GUI练手。</p>
<p>　　<span style="color: #ff0000;">图片阅读器</span>，超简单版。</p>
<p>　　<a href="http://files.cnblogs.com/JavaForNow/imageViewer.zip">下JAR点我</a></p>
<p>　　要用Graphics类在面板上绘图，这个面板得继承JPanel，然后重写paintComponent(Graphics g)方法，里边就用g来各种draw各种玩弄。</p>
<p>　　比如drawImage(img, x, y, observer)第四个参数指的是画图位置，当然用this就可以了。</p>
<p>　　observer前面多几个参数的话还可以指定绘图的范围，目测是直接缩放。</p>
<p>　　然后还用了下各种Menu，记得，JMenuItem是最小的，是单个菜单选项，JMenu第二小，是单个菜单，比如文件啊编辑啊关于啊。JMenuBar最大，是整个菜单栏。</p>
<p>　　菜单定义好了之后使用JFrame的方法，setMenuBar(JMenuBar menu)，就搞定了。</p>
<p>&nbsp;</p>
<p>　　不过因为不知道怎么获取菜单栏的高度，加上Win7的窗口好像本来就有点问题，图片画不全，会有一部分看不到哦草我突然想起来忘了设Resizable，懒得重新打包了。</p>
<p>　　于是就用了一个非常蠢的方法，对你没有猜错，现在打进电话我就告诉你我给宽度加了16，高度加了59。这个想不到该怎么解决，之后有缘再改吧。</p>
<p>&nbsp;</p>
<p>　　另外还用了下FileFilter类，这个类比较麻烦，得继承它，然后重写accept和getDescription两个方法，第一个接收文件返回布尔值，第二个返回字符串。下边分开说。</p>
<p>　　accept方法作用是限制JFileChooser能接受的文件类型，写法是分别判断，想用的比如.jpg文件就返回true，不想显示的比如.txt文件就返回false，另外一定注意，要判断一下file是不是目录，如果是目录的话也要返回true，否则就看不到目录了。</p>
<p>　　getDescription方法返回值是下边文件类型框里的文字，比如&ldquo;所有文件&rdquo;什么的，主要是给用户看的啦。</p>
<p>&nbsp;</p>
<p>　　发文前我又测试了一下，发现框架这次又太大了不知道怎么回事，反正把蠢方法的宽高都减了10，这回能看了。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('17ef54ad-0667-4e91-ada4-e60b35c4b9ae')"><img id="code_img_closed_17ef54ad-0667-4e91-ada4-e60b35c4b9ae" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_17ef54ad-0667-4e91-ada4-e60b35c4b9ae" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('17ef54ad-0667-4e91-ada4-e60b35c4b9ae',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_17ef54ad-0667-4e91-ada4-e60b35c4b9ae" class="cnblogs_code_hide">
<pre><span style="color: #008080;">  1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> imageViewer;
</span><span style="color: #008080;">  2</span> 
<span style="color: #008080;">  3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.awt.Color;
</span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.awt.event.ActionListener;
</span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.awt.event.ActionEvent;
</span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.awt.Graphics;
</span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.awt.Image;
</span><span style="color: #008080;">  8</span> 
<span style="color: #008080;">  9</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.ImageIcon;
</span><span style="color: #008080;"> 10</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.JFrame;
</span><span style="color: #008080;"> 11</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.JPanel;
</span><span style="color: #008080;"> 12</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.JMenuItem;
</span><span style="color: #008080;"> 13</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.JMenu;
</span><span style="color: #008080;"> 14</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.JMenuBar;
</span><span style="color: #008080;"> 15</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.JFileChooser;
</span><span style="color: #008080;"> 16</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.filechooser.FileFilter;
</span><span style="color: #008080;"> 17</span> 
<span style="color: #008080;"> 18</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.File;
</span><span style="color: #008080;"> 19</span> 
<span style="color: #008080;"> 20</span> @SuppressWarnings("serial"<span style="color: #000000;">)
</span><span style="color: #008080;"> 21</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MainFrame <span style="color: #0000ff;">extends</span><span style="color: #000000;"> JFrame{
</span><span style="color: #008080;"> 22</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> MyPanel panel;
</span><span style="color: #008080;"> 23</span>     
<span style="color: #008080;"> 24</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> MainFrame() {
</span><span style="color: #008080;"> 25</span>         <span style="color: #008000;">//</span><span style="color: #008000;">初始化菜单栏。</span>
<span style="color: #008080;"> 26</span>         JMenuItem openOption = <span style="color: #0000ff;">new</span> JMenuItem("打开"<span style="color: #000000;">);
</span><span style="color: #008080;"> 27</span>         JMenuItem exitOption = <span style="color: #0000ff;">new</span> JMenuItem("退出"<span style="color: #000000;">);
</span><span style="color: #008080;"> 28</span>         
<span style="color: #008080;"> 29</span>         openOption.addActionListener(<span style="color: #0000ff;">new</span> OpenListener(<span style="color: #0000ff;">this</span><span style="color: #000000;">));
</span><span style="color: #008080;"> 30</span>         exitOption.addActionListener(<span style="color: #0000ff;">new</span><span style="color: #000000;"> ExitListener());
</span><span style="color: #008080;"> 31</span>         
<span style="color: #008080;"> 32</span>         JMenu menu = <span style="color: #0000ff;">new</span> JMenu("文件"<span style="color: #000000;">);
</span><span style="color: #008080;"> 33</span> <span style="color: #000000;">        menu.add(openOption);
</span><span style="color: #008080;"> 34</span> <span style="color: #000000;">        menu.add(exitOption);
</span><span style="color: #008080;"> 35</span>         
<span style="color: #008080;"> 36</span>         JMenuBar menuBar = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JMenuBar();
</span><span style="color: #008080;"> 37</span> <span style="color: #000000;">        menuBar.add(menu);
</span><span style="color: #008080;"> 38</span>         
<span style="color: #008080;"> 39</span>         <span style="color: #008000;">//</span><span style="color: #008000;">初始化绘图面板。</span>
<span style="color: #008080;"> 40</span>         panel = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MyPanel();
</span><span style="color: #008080;"> 41</span>         panel.setBackground(<span style="color: #0000ff;">new</span> Color(66, 204, 255<span style="color: #000000;">));
</span><span style="color: #008080;"> 42</span>         
<span style="color: #008080;"> 43</span>         <span style="color: #0000ff;">this</span><span style="color: #000000;">.add(panel);
</span><span style="color: #008080;"> 44</span>         <span style="color: #0000ff;">this</span><span style="color: #000000;">.setJMenuBar(menuBar);
</span><span style="color: #008080;"> 45</span>         
<span style="color: #008080;"> 46</span>         <span style="color: #0000ff;">this</span>.setResizable(<span style="color: #0000ff;">false</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 47</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 48</span>     
<span style="color: #008080;"> 49</span>     <span style="color: #0000ff;">public</span> MyPanel getPanel() {<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">.panel;}
</span><span style="color: #008080;"> 50</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 51</span> 
<span style="color: #008080;"> 52</span> <span style="color: #008000;">/**</span><span style="color: #008000;"> 自定义绘图面板。</span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 53</span> <span style="color: #0000ff;">class</span> MyPanel <span style="color: #0000ff;">extends</span><span style="color: #000000;"> JPanel {
</span><span style="color: #008080;"> 54</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">long</span> serialVersionUID = 287940773057884149L<span style="color: #000000;">;
</span><span style="color: #008080;"> 55</span> <span style="color: #000000;">    Image img;
</span><span style="color: #008080;"> 56</span>     
<span style="color: #008080;"> 57</span>     <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> paintComponent(Graphics g) {
</span><span style="color: #008080;"> 58</span>         g.drawImage(img, 0, 0, <span style="color: #0000ff;">this</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 59</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 60</span>     
<span style="color: #008080;"> 61</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> setImage(Image img) {<span style="color: #0000ff;">this</span>.img =<span style="color: #000000;"> img;}
</span><span style="color: #008080;"> 62</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 63</span> 
<span style="color: #008080;"> 64</span> <span style="color: #008000;">/**</span><span style="color: #008000;">&ldquo;打开&rdquo;菜单项的事件监听器。</span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 65</span> <span style="color: #0000ff;">class</span> OpenListener <span style="color: #0000ff;">implements</span><span style="color: #000000;"> ActionListener {
</span><span style="color: #008080;"> 66</span> <span style="color: #000000;">    MainFrame parent;
</span><span style="color: #008080;"> 67</span>     
<span style="color: #008080;"> 68</span>     OpenListener(MainFrame parent) {<span style="color: #0000ff;">this</span>.parent =<span style="color: #000000;"> parent;}
</span><span style="color: #008080;"> 69</span>     
<span style="color: #008080;"> 70</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> actionPerformed(ActionEvent e) {
</span><span style="color: #008080;"> 71</span> <span style="color: #000000;">        Image img;
</span><span style="color: #008080;"> 72</span>         <span style="color: #0000ff;">if</span> ((img = getImage()) != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;"> 73</span> <span style="color: #000000;">            parent.getPanel().setImage(img);
</span><span style="color: #008080;"> 74</span> <span style="color: #000000;">            parent.getPanel().repaint();
</span><span style="color: #008080;"> 75</span>             parent.setSize(img.getWidth(parent)+6, img.getHeight(parent)+49<span style="color: #000000;">);
</span><span style="color: #008080;"> 76</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;"> 77</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 78</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 79</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 80</span>     
<span style="color: #008080;"> 81</span>     <span style="color: #008000;">/**</span><span style="color: #008000;">提示并获取文件，然后返回它。</span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 82</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> File getFile() {
</span><span style="color: #008080;"> 83</span>         JFileChooser fileChooser = <span style="color: #0000ff;">new</span><span style="color: #000000;"> JFileChooser();
</span><span style="color: #008080;"> 84</span> <span style="color: #000000;">        fileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);
</span><span style="color: #008080;"> 85</span>         fileChooser.setMultiSelectionEnabled(<span style="color: #0000ff;">false</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 86</span>         fileChooser.setCurrentDirectory(<span style="color: #0000ff;">new</span> File("."<span style="color: #000000;">));
</span><span style="color: #008080;"> 87</span>         fileChooser.setFileFilter(<span style="color: #0000ff;">new</span><span style="color: #000000;"> MyFilter());
</span><span style="color: #008080;"> 88</span>         fileChooser.setFileHidingEnabled(<span style="color: #0000ff;">true</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 89</span>         <span style="color: #0000ff;">if</span> (fileChooser.showOpenDialog(parent) ==<span style="color: #000000;"> JFileChooser.APPROVE_OPTION)
</span><span style="color: #008080;"> 90</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> fileChooser.getSelectedFile();
</span><span style="color: #008080;"> 91</span>         <span style="color: #0000ff;">else</span>
<span style="color: #008080;"> 92</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 93</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 94</span>     
<span style="color: #008080;"> 95</span>     <span style="color: #008000;">/**</span><span style="color: #008000;">利用getFile方法来读取文件内容并返回作为内容的图片。为了健壮性本来应该判断一下文件类型的，不过反正自己用就算了。</span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 96</span>     <span style="color: #0000ff;">private</span><span style="color: #000000;"> Image getImage() {
</span><span style="color: #008080;"> 97</span>         File file =<span style="color: #000000;"> getFile();
</span><span style="color: #008080;"> 98</span>         <span style="color: #0000ff;">if</span> (file == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 99</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">100</span>         <span style="color: #0000ff;">else</span>
<span style="color: #008080;">101</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> ImageIcon(file.getPath()).getImage();
</span><span style="color: #008080;">102</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">103</span>     
<span style="color: #008080;">104</span>     <span style="color: #008000;">/**</span><span style="color: #008000;">文件类型过滤器，外边用不着，就写成内部类。</span><span style="color: #008000;">*/</span>
<span style="color: #008080;">105</span>     <span style="color: #0000ff;">class</span> MyFilter <span style="color: #0000ff;">extends</span><span style="color: #000000;"> FileFilter {
</span><span style="color: #008080;">106</span> <span style="color: #000000;">        @Override
</span><span style="color: #008080;">107</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> accept(File f) {
</span><span style="color: #008080;">108</span>             <span style="color: #0000ff;">return</span> (f.isDirectory() ||
<span style="color: #008080;">109</span>                     f.getName().endsWith(".jpg") ||
<span style="color: #008080;">110</span>                     f.getName().endsWith(".gif") ||
<span style="color: #008080;">111</span>                     f.getName().endsWith(".png"<span style="color: #000000;">));
</span><span style="color: #008080;">112</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">113</span>         
<span style="color: #008080;">114</span> <span style="color: #000000;">        @Override
</span><span style="color: #008080;">115</span>         <span style="color: #0000ff;">public</span><span style="color: #000000;"> String getDescription() {
</span><span style="color: #008080;">116</span>             <span style="color: #0000ff;">return</span> ".jpg|.gif|.png"<span style="color: #000000;">;
</span><span style="color: #008080;">117</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">118</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">119</span> <span style="color: #000000;">}
</span><span style="color: #008080;">120</span> 
<span style="color: #008080;">121</span> <span style="color: #008000;">/**</span><span style="color: #008000;">&ldquo;退出&rdquo;菜单项的事件监听器。</span><span style="color: #008000;">*/</span>
<span style="color: #008080;">122</span> <span style="color: #0000ff;">class</span> ExitListener <span style="color: #0000ff;">implements</span><span style="color: #000000;"> ActionListener {
</span><span style="color: #008080;">123</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> actionPerformed(ActionEvent e) {
</span><span style="color: #008080;">124</span>         System.exit(0<span style="color: #000000;">);
</span><span style="color: #008080;">125</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">126</span> }</pre>
</div>
<span class="cnblogs_code_collapse">框架和监听器</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('981b1e29-5e2e-4b35-8ce9-da1dc9e6d3aa')"><img id="code_img_closed_981b1e29-5e2e-4b35-8ce9-da1dc9e6d3aa" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_981b1e29-5e2e-4b35-8ce9-da1dc9e6d3aa" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('981b1e29-5e2e-4b35-8ce9-da1dc9e6d3aa',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_981b1e29-5e2e-4b35-8ce9-da1dc9e6d3aa" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> imageViewer;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.JFrame;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.UIManager;
</span><span style="color: #008080;"> 5</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.swing.UnsupportedLookAndFeelException;
</span><span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Run {
</span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
</span><span style="color: #008080;"> 9</span>         <span style="color: #008000;">//</span><span style="color: #008000;">设置窗口风格。</span>
<span style="color: #008080;">10</span>         <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
</span><span style="color: #008080;">11</span>             UIManager.setLookAndFeel("com.sun.java.swing.plaf.windows.WindowsLookAndFeel"<span style="color: #000000;">);
</span><span style="color: #008080;">12</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (UnsupportedLookAndFeelException ule) {
</span><span style="color: #008080;">13</span> <span style="color: #000000;">            ule.printStackTrace();
</span><span style="color: #008080;">14</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IllegalAccessException iae) {
</span><span style="color: #008080;">15</span> <span style="color: #000000;">            iae.printStackTrace();
</span><span style="color: #008080;">16</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (InstantiationException ie) {
</span><span style="color: #008080;">17</span> <span style="color: #000000;">            ie.printStackTrace();
</span><span style="color: #008080;">18</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (ClassNotFoundException cnfe) {
</span><span style="color: #008080;">19</span> <span style="color: #000000;">            cnfe.printStackTrace();
</span><span style="color: #008080;">20</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">21</span>         
<span style="color: #008080;">22</span>         <span style="color: #008000;">//</span><span style="color: #008000;">新建窗口并设置框架属性。</span>
<span style="color: #008080;">23</span>         MainFrame frame = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MainFrame();
</span><span style="color: #008080;">24</span>         frame.setTitle("简易图片阅读器"<span style="color: #000000;">);
</span><span style="color: #008080;">25</span>         frame.setSize(400, 400<span style="color: #000000;">);
</span><span style="color: #008080;">26</span>         frame.setLocationRelativeTo(<span style="color: #0000ff;">null</span><span style="color: #000000;">);
</span><span style="color: #008080;">27</span> <span style="color: #000000;">        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
</span><span style="color: #008080;">28</span>         frame.setVisible(<span style="color: #0000ff;">true</span><span style="color: #000000;">);
</span><span style="color: #008080;">29</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">30</span> }</pre>
</div>
<span class="cnblogs_code_collapse">运行类</span></div>
<p>&nbsp;</p>
<p>　　对了，为了提醒某个看得起我真的拿我的代码去用了的人，我的java文件头上有package行，得放进相应的文件夹里，如果要单独拿出class文件来用的话把文件里的package XXXX删掉就行了。</p>

<p align=right><span style="font-size: 12px">——本文由博客园搬家工具<a href="https://github.com/mlxy/SRBCnblogs">SRBCnblogs</a>转换而成</span></p>