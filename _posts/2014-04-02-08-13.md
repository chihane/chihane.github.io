---
layout: post
title: GUI搞定
date: 2014-04-02 08:13:00
categories: cnblogs
---

<p>https://github.com/mlxy/NCWeather</p>
<p>重写了WeatherImages类，虽然之前从来没用上过。</p>
<p>现在天气图标已经可以正常变化了。</p>
<p>也就是说。</p>
<p>GUI已经搞定了。</p>
<p>剩下的就是一些细节的修改。</p>
<p>&nbsp;</p>
<p>再到1.0为止的两个版本就改一改内部代码就行了。</p>
<p>&nbsp;</p>
<p>我发现我最近的博文已经开始不讲技术细节了&hellip;&hellip;仿佛不是好现象。</p>
<p>&nbsp;</p>
<p>图就不发了，反正看起来和之前发的图一样。</p>
<p>工程也不发了吧，反正变化不多。</p>
<p>总之就是这样。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('34cad424-e100-4eba-83a7-3bbd88ed17d4')"><img id="code_img_closed_34cad424-e100-4eba-83a7-3bbd88ed17d4" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_34cad424-e100-4eba-83a7-3bbd88ed17d4" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('34cad424-e100-4eba-83a7-3bbd88ed17d4',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_34cad424-e100-4eba-83a7-3bbd88ed17d4" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span>     <span style="color: #008000;">/**</span><span style="color: #008000;"> 获取根据系统时间返回白天或夜晚的天气图片。</span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 2</span>     <span style="color: #0000ff;">public</span><span style="color: #000000;"> Bitmap getWeatherImage() {
</span><span style="color: #008080;"> 3</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> 获取当前小时，24小时制。</span>
<span style="color: #008080;"> 4</span>         Calendar c =<span style="color: #000000;"> Calendar.getInstance();
</span><span style="color: #008080;"> 5</span>         <span style="color: #0000ff;">int</span> hour =<span style="color: #000000;"> c.get(Calendar.HOUR_OF_DAY);
</span><span style="color: #008080;"> 6</span>         
<span style="color: #008080;"> 7</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> 根据时间获取文件夹名称。根据时间获取天气，用天气获取对应图片的文件名。</span>
<span style="color: #008080;"> 8</span>         String dayOrNight = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 9</span>         String fileName = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">10</span>         
<span style="color: #008080;">11</span>         <span style="color: #0000ff;">if</span> (hour &lt;= 6 || hour &gt;= 18<span style="color: #000000;">) {
</span><span style="color: #008080;">12</span>             dayOrNight = "night"<span style="color: #000000;">;
</span><span style="color: #008080;">13</span>             String weatherPinyin =<span style="color: #000000;"> map.get(WeatherTag.NIGHT_WEATHER_PINYIN);
</span><span style="color: #008080;">14</span>             fileName =<span style="color: #000000;"> WeatherImages.getFileName(weatherPinyin);
</span><span style="color: #008080;">15</span>         } <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">16</span>             dayOrNight = "day"<span style="color: #000000;">;
</span><span style="color: #008080;">17</span>             String weatherPinyin =<span style="color: #000000;"> map.get(WeatherTag.DAY_WEATHER_PINYIN);
</span><span style="color: #008080;">18</span>             fileName =<span style="color: #000000;"> WeatherImages.getFileName(weatherPinyin);
</span><span style="color: #008080;">19</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">20</span>         
<span style="color: #008080;">21</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> 获取资源包。</span>
<span style="color: #008080;">22</span>         AssetManager manager = <span style="color: #0000ff;">this</span><span style="color: #000000;">.parent.getResources().getAssets();
</span><span style="color: #008080;">23</span>         
<span style="color: #008080;">24</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> 用已经得到的变量获取对应图片对象。</span>
<span style="color: #008080;">25</span>         Bitmap image = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">26</span>         
<span style="color: #008080;">27</span>         <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
</span><span style="color: #008080;">28</span>             InputStream in = manager.open("weather/" + dayOrNight+ "/" +<span style="color: #000000;"> fileName);
</span><span style="color: #008080;">29</span>             image =<span style="color: #000000;"> BitmapFactory.decodeStream(in);
</span><span style="color: #008080;">30</span> <span style="color: #000000;">            in.close();
</span><span style="color: #008080;">31</span>         } <span style="color: #0000ff;">catch</span><span style="color: #000000;">(IOException e) {
</span><span style="color: #008080;">32</span> <span style="color: #000000;">            e.printStackTrace();
</span><span style="color: #008080;">33</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">34</span>         
<span style="color: #008080;">35</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> image;
</span><span style="color: #008080;">36</span>     }</pre>
</div>
<span class="cnblogs_code_collapse">DataGetter里新加的方法</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('76e5998a-81cc-448b-9590-24343a06076c')"><img id="code_img_closed_76e5998a-81cc-448b-9590-24343a06076c" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_76e5998a-81cc-448b-9590-24343a06076c" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('76e5998a-81cc-448b-9590-24343a06076c',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_76e5998a-81cc-448b-9590-24343a06076c" class="cnblogs_code_hide">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">package</span><span style="color: #000000;"> com.mlxy.property;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.HashMap;
</span><span style="color: #008080;"> 4</span> <span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Map;
</span><span style="color: #008080;"> 5</span> 
<span style="color: #008080;"> 6</span> 
<span style="color: #008080;"> 7</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> WeatherImages {
</span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> Map&lt;String, String&gt; map  = <span style="color: #0000ff;">new</span> HashMap&lt;String, String&gt;<span style="color: #000000;">() {
</span><span style="color: #008080;"> 9</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> <span style="color: #0000ff;">long</span> serialVersionUID = -8552791002402932770L<span style="color: #000000;">;
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">12</span>         put("qing", "00.png"<span style="color: #000000;">);
</span><span style="color: #008080;">13</span>         put("duoyun", "01.png"<span style="color: #000000;">);
</span><span style="color: #008080;">14</span>         put("yin", "02.png"<span style="color: #000000;">);
</span><span style="color: #008080;">15</span>         put("zhenyu", "03.png"<span style="color: #000000;">);
</span><span style="color: #008080;">16</span>         put("leizhenyu", "04.png"<span style="color: #000000;">);
</span><span style="color: #008080;">17</span>         put("leizhenyubanyoubingbao", "05.png"<span style="color: #000000;">);
</span><span style="color: #008080;">18</span>         put("yujiaxue", "06.png"<span style="color: #000000;">);
</span><span style="color: #008080;">19</span>         put("xiaoyu", "07.png"<span style="color: #000000;">);
</span><span style="color: #008080;">20</span>         put("zhongyu", "08.png"<span style="color: #000000;">);
</span><span style="color: #008080;">21</span>         put("dayu", "09.png"<span style="color: #000000;">);
</span><span style="color: #008080;">22</span>         put("baoyu", "10.png"<span style="color: #000000;">);
</span><span style="color: #008080;">23</span>         put("dabaoyu", "11.png"<span style="color: #000000;">);
</span><span style="color: #008080;">24</span>         put("tedabaoyu", "12.png"<span style="color: #000000;">);
</span><span style="color: #008080;">25</span>         put("zhenxue", "13.png"<span style="color: #000000;">);
</span><span style="color: #008080;">26</span>         put("xiaoxue", "14.png"<span style="color: #000000;">);
</span><span style="color: #008080;">27</span>         put("zhongxue", "15.png"<span style="color: #000000;">);
</span><span style="color: #008080;">28</span>         put("daxue", "16.png"<span style="color: #000000;">);
</span><span style="color: #008080;">29</span>         put("baoxue", "17.png"<span style="color: #000000;">);
</span><span style="color: #008080;">30</span>         put("wu", "18.png"<span style="color: #000000;">);
</span><span style="color: #008080;">31</span>         put("dongyu", "19.png"<span style="color: #000000;">);
</span><span style="color: #008080;">32</span>         put("shachenbao", "20.png"<span style="color: #000000;">);
</span><span style="color: #008080;">33</span>         put("xiaodaozhongyu", "21.png"<span style="color: #000000;">);
</span><span style="color: #008080;">34</span>         put("zhongdaodayu", "22.png"<span style="color: #000000;">);
</span><span style="color: #008080;">35</span>         put("dadaobaoyu", "23.png"<span style="color: #000000;">);
</span><span style="color: #008080;">36</span>         put("baoyudaodabaoyu", "24.png"<span style="color: #000000;">);
</span><span style="color: #008080;">37</span>         put("dabaoyudaotedabaoyu", "25.png"<span style="color: #000000;">);
</span><span style="color: #008080;">38</span>         put("xiaodaozhongxue", "26.png"<span style="color: #000000;">);
</span><span style="color: #008080;">39</span>         put("zhongdaodaxue", "27.png"<span style="color: #000000;">);
</span><span style="color: #008080;">40</span>         put("dadaobaoxue", "28.png"<span style="color: #000000;">);
</span><span style="color: #008080;">41</span>         put("fuchen", "29.png"<span style="color: #000000;">);
</span><span style="color: #008080;">42</span>         put("yangsha", "30.png"<span style="color: #000000;">);
</span><span style="color: #008080;">43</span>         put("qiangshachenbao", "31.png"<span style="color: #000000;">);
</span><span style="color: #008080;">44</span>         put("mai", "53.png"<span style="color: #000000;">);
</span><span style="color: #008080;">45</span>         put("unknown", "undefined.png"<span style="color: #000000;">);
</span><span style="color: #008080;">46</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">47</span> <span style="color: #000000;">    };
</span><span style="color: #008080;">48</span>     
<span style="color: #008080;">49</span>     <span style="color: #008000;">/**</span> 
<span style="color: #008080;">50</span> <span style="color: #008000;">     * 根据天气名称的拼音返回对应图片的文件名。
</span><span style="color: #008080;">51</span> <span style="color: #008000;">     * 
</span><span style="color: #008080;">52</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> weather 天气名的拼音。
</span><span style="color: #008080;">53</span> <span style="color: #008000;">     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> fileName 天气名称的拼音对应的文件名。如果找不到就返回unknown图片的文件名。</span><span style="color: #008000;">*/</span>
<span style="color: #008080;">54</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> String getFileName(String weather) {
</span><span style="color: #008080;">55</span>         String fileName =<span style="color: #000000;"> map.get(weather);
</span><span style="color: #008080;">56</span>         
<span style="color: #008080;">57</span>         <span style="color: #008000;">//</span><span style="color: #008000;"> 如果找不到就返回unknown图片的文件名。</span>
<span style="color: #008080;">58</span>         <span style="color: #0000ff;">if</span> (fileName == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
</span><span style="color: #008080;">59</span>             fileName = map.get("unknown"<span style="color: #000000;">);
</span><span style="color: #008080;">60</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">61</span>         
<span style="color: #008080;">62</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> fileName;
</span><span style="color: #008080;">63</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">64</span> }</pre>
</div>
<span class="cnblogs_code_collapse">重写的WeatherImages类</span></div>
<p>MainActivity里的代码就很好懂了：</p>
<p>取得Bitmap类型的图片：</p>
<div class="cnblogs_code">
<pre>weatherImage = getter.getWeatherImage();</pre>
</div>
<p>设置进去：</p>
<div class="cnblogs_code">
<pre>weatherImageView.setImageBitmap(weatherImage);</pre>
</div>
<p>&nbsp;</p>
<p>就完事啦 /w\</p>
<p>&nbsp;</p>

<div align=right><a href="https://github.com/mlxy/SRBCnblogs"><font size=1>——本文由博客园搬家工具SRBCnblogs转换而成</font></a></div>