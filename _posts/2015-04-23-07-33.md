---
layout: post
title: 【1】《50 Android Hacks（安卓五十技）》翻译——三顾频烦天下技
date: 2015-04-23 07:33:00
categories: cnblogs
---

<p>然而这书已经有了地球人翻译的版本。</p>
<p>http://item.jd.com/11431447.html</p>
<p>地球人可以看这个。</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p style="text-align: center;"><em><span style="font-size: 18pt;"><strong>第一章 搞一搞布局</strong></span></em></p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;"><strong>第一技 使用权重(weight)居中控件(View)</strong>&nbsp;</span> [Android 1.6+]</p>
<p>&nbsp;</p>
<p>　　有一回我去参加<span style="text-decoration: line-through;">谷歌</span>开发者大会，我在讲怎么用XML创建控件的时候有个人插嘴，说&ldquo;我要是想让一个控件居中而且宽度是父控件的一半该怎么写？&rdquo;我一开始没听懂他说的什么玩意，不过他后来跑上来在黑板上画了图我就懂了。见图一和图二。</p>
<p style="text-align: center;"><img src="http://images.cnitblog.com/blog2015/580469/201504/231447382188700.png" alt="" /></p>
<p style="text-align: center;"><strong>&middot;图一 按钮宽度占父布局一半（纵向）</strong></p>
<p style="text-align: center;"><strong><img src="http://images.cnitblog.com/blog2015/580469/201504/231448240312837.png" alt="" /></strong></p>
<p style="text-align: center;">&nbsp;</p>
<p style="text-align: center;"><strong>&middot;图二&nbsp;<strong>按钮宽度占父布局一半（横向）</strong></strong></p>
<p>&nbsp;</p>
<p>　　看起来是不是特别简单？有种你试试再说。在这一技里，我就来教教你怎么<span style="text-decoration: line-through;">做人</span>用线性布局(LinearLayout)里的android:weightSum属性加上子控件的android:layout_weight属性来解决这个问题。这任务看起来挺简单的，但是我经常在跟<span style="text-decoration: line-through;">弱者</span>开发者聊天的时候问起这个问题，因为很多人都不知道最好的解决方法。</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>1.1 我来组成权重和(weightSum)和布局权重(layout_weight)</strong></span></p>
<p>　　Android设备有各种大小，作为开发者你就得写XML来应对各种大小。硬编码尺寸值并不可取，所以我们得想点别的招来组织控件。</p>
<p>　　重要的事情说到了第三遍，我们要用权重和以及布局权重来把我们的布局里剩下的空间塞满。android:weightSum的API文档(详见我不一定能翻译到的1.3章)描述了一个跟我们想做的差不多的场景：</p>
<blockquote>
<p>定义最大权重和。如果没有指定，权重和就由所有子控件的layout_weight相加得到。如果想让单个子控件得到所有可用空间的一半，可以通过把它的layout_weight设为0.5，然后把weightSum设为1.0来实现。</p>
</blockquote>
<p>就像是我们要把小○○塞入一个小○里一样。weightSum就是可用空间的百分比，而layout_weight就是小○里的每个小○○能占的百分比。假设小红的小○的weightSum是1，里面放了两个小○○，分别是小明的小○○和小刚的小○○。小明的小○○的layout_weight是0.25，小刚的小○○则是0.75，于是小明的小○○就占有了小红的小○25%的空间，而小刚的小○○就占据了剩下的75%。</p>
<p>　　本章开头的那个情况的解决办法也是差不多的。给父布局一个指定的weightSum，再把按钮的android:layout_weight指定成它一半的值。关门放XML：</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">LinearLayout </span><span style="color: #ff0000;">xmlns:android</span><span style="color: #0000ff;">="http://schemas.android.com/apk/res/android"</span>
<span style="color: #008080;"> 3</span> <span style="color: #ff0000;">    android:layout_width</span><span style="color: #0000ff;">="fill_parent"</span>
<span style="color: #008080;"> 4</span> <span style="color: #ff0000;">    android:layout_height</span><span style="color: #0000ff;">="fill_parent"</span>
<span style="color: #008080;"> 5</span> <span style="color: #ff0000;">    android:background</span><span style="color: #0000ff;">="#FFFFFF"</span>
<span style="color: #008080;"> 6</span> <span style="color: #ff0000;">    android:gravity</span><span style="color: #0000ff;">="center"</span>
<span style="color: #008080;"> 7</span> <span style="color: #ff0000;">    android:orientation</span><span style="color: #0000ff;">="horizontal"</span>
<span style="color: #008080;"> 8</span> <span style="color: #ff0000;">    android:weightSum</span><span style="color: #0000ff;">="1"</span> <span style="color: #0000ff;">&gt;</span>
<span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span>     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Button
</span><span style="color: #008080;">11</span>         <span style="color: #ff0000;">android:layout_width</span><span style="color: #0000ff;">="0dp"</span>
<span style="color: #008080;">12</span> <span style="color: #ff0000;">        android:layout_height</span><span style="color: #0000ff;">="wrap_content"</span>
<span style="color: #008080;">13</span> <span style="color: #ff0000;">        android:layout_weight</span><span style="color: #0000ff;">="0.5"</span>
<span style="color: #008080;">14</span> <span style="color: #ff0000;">        android:text</span><span style="color: #0000ff;">="Click me"</span> <span style="color: #0000ff;">/&gt;</span>
<span style="color: #008080;">15</span> 
<span style="color: #008080;">16</span> <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">LinearLayout</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>　　线性布局读到了android:weightSum，就知道了它所有子控件权重的和是1。又因为它第一个也是唯一一个子控件，按钮，的android:layout_width设成了0dp，线性布局就知道了它得用android:weightSum给的值来决定这个按钮的宽度。然后又因为按钮的android:layout_weight设成的0.5，于是它就正好占了所有可用空间的一半。</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="http://images.cnitblog.com/blog2015/580469/201504/231526053289998.jpg" alt="" /></p>
<p>　　比如线性布局的宽度是200dp，android:weightSum是1。按钮的实际宽度就是这么算的：</p>
<blockquote>
<p>按钮的指定宽度 + 按钮的权重 * 200 / 权重和</p>
</blockquote>
<p>∵按钮的指定宽度 = 0(dp)</p>
<p>又∵按钮的权重 = 0.5</p>
<p>&there4;按钮的实际宽度 = 0 + 0.5 * 200 / 1 = 100(dp)</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>1.2 The bottom line 怎么翻译比较好，在线等，挺急的。</strong></span></p>
<p>　　如果想基于百分比给线性布局分配可用空间，权重还是挺重要的，反正比硬编码强。如果你在3.0以上搞开发而且用过Fragment，你可能发现大部分示例代码都是用权重来把不同的Fragment放到布局里的。学会用权重也算是get&radic;了个新技能。</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>1.3 外部链接</strong></span></p>
<p>http://developer.android.com/reference/android/widget/LinearLayout.html</p>

<div align=right><a href="https://github.com/mlxy"><font size=1>——本文由博客园搬家工具SRBCnblogs转换而成</font></a></div>