---
layout: post
title: 干
date: 2015-12-14 14:29
categories: CATEGORY
tags: [TAG]
---

{% highlight python %}
# coding:utf-8

import sys
import xml.dom.minidom
import os
import time

reload(sys)
sys.setdefaultencoding('utf-8')

BACKUP_FILE = 'CNBlogs_BlogBackup_131_201310_201512.xml'
TAIL = '<p align=right><span style="font-size: 12px">——本文由博客园搬家工具<a href="https://github.com/mlxy/SRBCnblogs">SRBCnblogs</a>转换而成</span></p>'

DOMTree = xml.dom.minidom.parse(BACKUP_FILE)
root = DOMTree.documentElement

blog_title = root.getElementsByTagName('title')[0].childNodes[0].data

if not os.path.isdir(blog_title):
    os.mkdir(blog_title)

blogs = root.getElementsByTagName('item')

for blog in blogs:
    title = blog.getElementsByTagName('title')[0].childNodes[0].data
    origin_link = blog.getElementsByTagName('link')[0].childNodes[0].data
    date = blog.getElementsByTagName('pubDate')[0].childNodes[0].data
    content = blog.getElementsByTagName('description')[0].childNodes[0].data

    timestamp = time.mktime(time.strptime(date, '%a, %d %b %Y %H:%M:%S GMT'))
    date_filename = time.strftime('%Y-%m-%d-%H-%M', time.localtime(timestamp))
    date_header = time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(timestamp))

    with open(blog_title + os.sep + date_filename + '.md', 'w') as f:
        f.writelines(['---\n', 'layout: post\n', 'title: %s\n' % title, 'date: %s\n' % date_header, 'categories: cnblogs\n', '---\n\n'])
        f.write(content)
        f.write('\n\n')
        f.write(TAIL)
        f.close()

{% endhighlight %}